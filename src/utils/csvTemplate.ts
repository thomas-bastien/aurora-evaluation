export function generateCSVTemplate(): string {
  // Documentation rows
  const docRows = [
    '# ========================================',
    '# STARTUPS CSV UPLOAD TEMPLATE',
    '# ========================================',
    '# REQUIRED FIELDS (must have values):',
    '#   - name (text - company name)',
    '#   - contact_email (email address)',
    '#   - description (text - brief company description)',
    '#',
    '# OPTIONAL FIELDS - BASIC INFO:',
    '#   - industry (text)',
    '#   - stage (text - funding stage)',
    '#   - status (text - application status)',
    '#   - location (text - city, state/country)',
    '#   - country (text)',
    '#   - founded_year (number - 4-digit year)',
    '#',
    '# OPTIONAL FIELDS - TEAM:',
    '#   - team_size (number - total team members)',
    '#   - full_time_team_members (number)',
    '#   - founder_names (array - semicolon-separated full names)',
    '#   - founder_first_name (text - primary contact)',
    '#   - founder_last_name (text - primary contact)',
    '#   - founder_linkedin (URL - primary founder LinkedIn)',
    '#',
    '# OPTIONAL FIELDS - BUSINESS:',
    '#   - business_model (array - semicolon-separated models)',
    '#   - verticals (array - semicolon-separated industries)',
    '#   - regions (array - semicolon-separated operating regions)',
    '#   - other_vertical_description (text - if vertical is "Others")',
    '#   - countries_operating (text)',
    '#   - countries_expansion_plan (text)',
    '#',
    '# OPTIONAL FIELDS - FINANCIAL:',
    '#   - funding_goal (number - amount seeking)',
    '#   - funding_raised (number - amount already raised)',
    '#   - total_investment_received (number - lifetime funding)',
    '#   - investment_currency (text - GBP/USD/EUR)',
    '#   - paying_customers_per_year (text - description)',
    '#',
    '# OPTIONAL FIELDS - MARKET & RISKS:',
    '#   - serviceable_obtainable_market (text)',
    '#   - business_risks_mitigation (text)',
    '#',
    '# OPTIONAL FIELDS - LINKS:',
    '#   - website (URL)',
    '#   - pitch_deck_url (URL)',
    '#   - demo_url (URL)',
    '#   - linkedin_url (URL - company page)',
    '#   - contact_phone (text - with country code)',
    '#',
    '# ARRAY FIELDS (use semicolon ; to separate multiple values):',
    '#   Example: "Seed;Series A" or "Europe;North America"',
    '#',
    '# VALID FUNDING STAGES:',
    '#   Pre-Seed, Seed, Series A, Series B, Series C+, Growth, IPO',
    '#',
    '# VALID APPLICATION STATUS:',
    '#   pending, under_review, approved, rejected, waitlisted',
    '#',
    '# VALID CURRENCIES:',
    '#   GBP (British Pound £)',
    '#   USD (US Dollar $)',
    '#   EUR (Euro €)',
    '#',
    '# VALID BUSINESS MODELS:',
    '#   B2C – Business to Consumer',
    '#   B2B2C – Business to Business to Consumer',
    '#   B2B – Business to Business (Enterprise & SMEs)',
    '#   B2B – Business to Business (Enterprise)',
    '#   B2B – Business to Business (SMEs)',
    '#   D2C – Direct to Consumer',
    '#   C2C – Consumer to Consumer (incl. Marketplaces/Platforms)',
    '#',
    '# VALID REGIONS:',
    '#   Africa',
    '#   Asia Pacific (APAC)',
    '#   Europe',
    '#   Latin America (LATAM)',
    '#   Middle East & North Africa (MENA)',
    '#   North America',
    '#   Other',
    '#',
    '# VALID VERTICALS (use exact spelling with parentheses):',
    '#   Artificial Intelligence (AI/ML)',
    '#   Fintech',
    '#   HealthTech & MedTech',
    '#   Wellbeing, Longevity & Life Sciences',
    '#   PharmTech',
    '#   RetailTech & E-commerce',
    '#   Enterprise Software',
    '#   Cybersecurity',
    '#   Productivity Tools',
    '#   Transportation & Mobility',
    '#   Energy & Sustainability',
    '#   AgriTech & Food Tech',
    '#   Media & Entertainment',
    '#   AdTech & MarTech',
    '#   Real Estate & PropTech',
    '#   Education Technology (EdTech)',
    '#   Logistics & Supply Chain',
    '#   Construction Tech',
    '#   Space Technology',
    '#   Semiconductors & Hardware',
    '#   Data Infrastructure & Analytics',
    '#   Industrial Automation & Robotics',
    '#   Aerospace & Defense',
    '#   Gaming & Visual Assets',
    '#   SportTech',
    '#   Web3 / Blockchain / Crypto',
    '#   TravelTech',
    '#   No Tech, not a Venture Business',
    '#   Others (Specify)',
    '#',
    '# DATA FORMAT TIPS:',
    '#   - Financial amounts: Use numbers only, no currency symbols (e.g., 1500000 for £1.5M)',
    '#   - Years: 4-digit format (e.g., 2023)',
    '#   - URLs: Must include http:// or https://',
    '#   - Phone: Include country code (e.g., +44 20 1234 5678)',
    '#   - Leave optional fields empty (blank) if not applicable',
    '#   - Use semicolons (;) to separate multiple values in array fields',
    ''
  ];

  const headers = [
    'name',
    'description',
    'contact_email',
    'industry',
    'stage',
    'location',
    'country',
    'regions',
    'founded_year',
    'team_size',
    'funding_goal',
    'funding_raised',
    'business_model',
    'verticals',
    'other_vertical_description',
    'website',
    'pitch_deck_url',
    'demo_url',
    'linkedin_url',
    'founder_names',
    'status',
    'investment_currency',
    'founder_first_name',
    'founder_last_name',
    'founder_linkedin',
    'contact_phone',
    'full_time_team_members',
    'paying_customers_per_year',
    'total_investment_received'
  ];

  const exampleRows = [
    // Complete example with all fields
    [
      'TechFlow Solutions',
      'AI-powered workflow automation platform for small businesses',
      'founder@techflow.com',
      'Technology',
      'Seed',
      'San Francisco, CA',
      'United States',
      'North America',
      '2022',
      '8',
      '2000000',
      '500000',
      'B2B – Business to Business (Enterprise & SMEs)',
      'Artificial Intelligence (AI/ML);Enterprise Software',
      '',
      'https://techflow.com',
      'https://drive.google.com/file/d/example-deck',
      'https://demo.techflow.com',
      'https://linkedin.com/company/techflow',
      'Jane Smith;John Doe',
      'pending',
      'USD',
      'Jane',
      'Smith',
      'https://linkedin.com/in/janesmith',
      '+1-415-555-0123',
      '6',
      '50-100',
      '750000'
    ],
    // Minimal example with only required fields
    [
      'EcoMart',
      'Sustainable e-commerce marketplace connecting eco-friendly brands',
      'hello@ecomart.io',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      ''
    ],
    // Mixed example with some optional fields
    [
      'HealthTrack AI',
      'Personalized health monitoring using wearable sensor data and machine learning',
      'contact@healthtrack.ai',
      'Healthcare',
      'Pre-Seed',
      'London, UK',
      'United Kingdom',
      'Europe',
      '2023',
      '5',
      '1500000',
      '250000',
      'B2C – Business to Consumer',
      'HealthTech & MedTech;Artificial Intelligence (AI/ML)',
      '',
      'https://healthtrack.ai',
      '',
      '',
      'https://linkedin.com/company/healthtrack-ai',
      'Dr. Sarah Chen;Michael O\'Connor',
      'under_review',
      'GBP',
      'Sarah',
      'Chen',
      'https://linkedin.com/in/sarahchen',
      '+44 20 7123 4567',
      '4',
      '10-25',
      '300000'
    ]
  ];

  const csvContent = [
    ...docRows,
    headers.join(','),
    ...exampleRows.map(row => row.map(cell => `"${cell}"`).join(','))
  ].join('\n');

  return csvContent;
}

export function downloadCSVTemplate(): void {
  const csvContent = generateCSVTemplate();
  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
  const link = document.createElement('a');
  const url = URL.createObjectURL(blob);
  
  link.setAttribute('href', url);
  link.setAttribute('download', 'startup_template.csv');
  link.style.visibility = 'hidden';
  
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}