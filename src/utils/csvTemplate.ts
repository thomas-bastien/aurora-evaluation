import * as XLSX from 'xlsx';

export function downloadStartupTemplate(): void {
  // Instructions sheet content (clean, no # markers)
  const instructions = [
    ['========================================'],
    ['STARTUPS UPLOAD TEMPLATE'],
    ['========================================'],
    [''],
    ['REQUIRED FIELDS (must have values):'],
    ['  - name (text - company name)'],
    ['  - contact_email (email address)'],
    ['  - description (text - brief company description)'],
    [''],
    ['OPTIONAL FIELDS - BASIC INFO:'],
    ['  - industry (text)'],
    ['  - stage (text - funding stage)'],
    ['  - status (text - application status)'],
    ['  - location (text - city, state/country)'],
    ['  - country (text)'],
    ['  - founded_year (number - 4-digit year)'],
    [''],
    ['OPTIONAL FIELDS - TEAM:'],
    ['  - team_size (number - total team members)'],
    ['  - full_time_team_members (number)'],
    ['  - founder_names (array - semicolon-separated full names)'],
    ['  - founder_first_name (text - primary contact)'],
    ['  - founder_last_name (text - primary contact)'],
    ['  - founder_linkedin (URL - primary founder LinkedIn)'],
    [''],
    ['OPTIONAL FIELDS - BUSINESS:'],
    ['  - business_model (array - semicolon-separated models)'],
    ['  - verticals (array - semicolon-separated industries)'],
    ['  - regions (array - semicolon-separated operating regions)'],
    ['  - other_vertical_description (text - if vertical is "Others")'],
    ['  - countries_operating (text)'],
    ['  - countries_expansion_plan (text)'],
    [''],
    ['OPTIONAL FIELDS - FINANCIAL:'],
    ['  - funding_goal (number - amount seeking)'],
    ['  - funding_raised (number - amount already raised)'],
    ['  - total_investment_received (number - lifetime funding)'],
    ['  - investment_currency (text - GBP/USD/EUR)'],
    ['  - paying_customers_per_year (text - description)'],
    [''],
    ['OPTIONAL FIELDS - MARKET & RISKS:'],
    ['  - serviceable_obtainable_market (text)'],
    ['  - business_risks_mitigation (text)'],
    [''],
    ['OPTIONAL FIELDS - LINKS:'],
    ['  - website (URL)'],
    ['  - pitch_deck_url (URL)'],
    ['  - demo_url (URL)'],
    ['  - linkedin_url (URL - company page)'],
    ['  - contact_phone (text - with country code)'],
    [''],
    ['========================================'],
    ['ARRAY FIELDS (use semicolon ; to separate multiple values):'],
    ['  Example: "Seed;Series A" or "Europe;North America"'],
    [''],
    ['========================================'],
    ['VALID FUNDING STAGES:'],
    ['  Pre-Seed, Seed, Series A, Series B, Series C+, Growth, IPO'],
    [''],
    ['VALID APPLICATION STATUS:'],
    ['  pending, under_review, approved, rejected, waitlisted'],
    [''],
    ['VALID CURRENCIES:'],
    ['  GBP (British Pound £)'],
    ['  USD (US Dollar $)'],
    ['  EUR (Euro €)'],
    [''],
    ['VALID BUSINESS MODELS:'],
    ['  B2C – Business to Consumer'],
    ['  B2B2C – Business to Business to Consumer'],
    ['  B2B – Business to Business (Enterprise & SMEs)'],
    ['  B2B – Business to Business (Enterprise)'],
    ['  B2B – Business to Business (SMEs)'],
    ['  D2C – Direct to Consumer'],
    ['  C2C – Consumer to Consumer (incl. Marketplaces/Platforms)'],
    [''],
    ['VALID REGIONS:'],
    ['  Africa'],
    ['  Asia Pacific (APAC)'],
    ['  Europe'],
    ['  Latin America (LATAM)'],
    ['  Middle East & North Africa (MENA)'],
    ['  North America'],
    ['  Other'],
    [''],
    ['VALID VERTICALS (use exact spelling with parentheses):'],
    ['  Artificial Intelligence (AI/ML)'],
    ['  Fintech'],
    ['  HealthTech & MedTech'],
    ['  Wellbeing, Longevity & Life Sciences'],
    ['  PharmTech'],
    ['  RetailTech & E-commerce'],
    ['  Enterprise Software'],
    ['  Cybersecurity'],
    ['  Productivity Tools'],
    ['  Transportation & Mobility'],
    ['  Energy & Sustainability'],
    ['  AgriTech & Food Tech'],
    ['  Media & Entertainment'],
    ['  AdTech & MarTech'],
    ['  Real Estate & PropTech'],
    ['  Education Technology (EdTech)'],
    ['  Logistics & Supply Chain'],
    ['  Construction Tech'],
    ['  Space Technology'],
    ['  Semiconductors & Hardware'],
    ['  Data Infrastructure & Analytics'],
    ['  Industrial Automation & Robotics'],
    ['  Aerospace & Defense'],
    ['  Gaming & Visual Assets'],
    ['  SportTech'],
    ['  Web3 / Blockchain / Crypto'],
    ['  TravelTech'],
    ['  No Tech, not a Venture Business'],
    ['  Others (Specify)'],
    [''],
    ['========================================'],
    ['DATA FORMAT TIPS:'],
    ['  - Financial amounts: Use numbers only, no currency symbols (e.g., 1500000 for £1.5M)'],
    ['  - Years: 4-digit format (e.g., 2023)'],
    ['  - URLs: Must include http:// or https://'],
    ['  - Phone: Include country code (e.g., +44 20 1234 5678)'],
    ['  - Leave optional fields empty (blank) if not applicable'],
    ['  - Use semicolons (;) to separate multiple values in array fields']
  ];

  // Headers for data template
  const headers = [
    'name',
    'contact_email',
    'description',
    'industry',
    'stage',
    'status',
    'location',
    'country',
    'founded_year',
    'team_size',
    'founder_names',
    'website',
    'pitch_deck_url',
    'demo_url',
    'linkedin_url',
    'funding_goal',
    'funding_raised',
    'business_model',
    'verticals',
    'regions',
    'other_vertical_description',
    'serviceable_obtainable_market',
    'business_risks_mitigation',
    'countries_operating',
    'countries_expansion_plan',
    'investment_currency',
    'founder_first_name',
    'founder_last_name',
    'founder_linkedin',
    'contact_phone',
    'full_time_team_members',
    'paying_customers_per_year',
    'total_investment_received'
  ];

  // Example rows
  const exampleRows = [
    // Complete example with all fields populated
    [
      'TechVenture AI',
      'contact@techventure.ai',
      'AI-powered analytics platform for enterprise data insights',
      'Enterprise Software',
      'Series A',
      'approved',
      'London, UK',
      'United Kingdom',
      '2021',
      '15',
      'Jane Smith;John Doe;Alice Johnson',
      'https://techventure.ai',
      'https://docsend.com/view/techventure-deck',
      'https://demo.techventure.ai',
      'https://linkedin.com/company/techventure-ai',
      '5000000',
      '1500000',
      'B2B – Business to Business (Enterprise);B2B2C – Business to Business to Consumer',
      'Artificial Intelligence (AI/ML);Enterprise Software;Data Infrastructure & Analytics',
      'Europe;North America',
      '',
      '$2B TAM in enterprise analytics',
      'Market competition mitigated by proprietary AI algorithms and strong customer retention',
      'UK, USA, Germany',
      'France, Spain, Netherlands (2025)',
      'GBP',
      'Jane',
      'Smith',
      'https://linkedin.com/in/janesmith',
      '+1-415-555-0123',
      '6',
      '50-100',
      '750000'
    ],
    // Minimal example with only required fields
    [
      'HealthTech Solutions',
      'info@healthtech.io',
      'Digital health platform connecting patients with specialists',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      '',
      ''
    ],
    // Mixed example with partial data
    [
      'EcoMobility',
      'hello@ecomobility.com',
      'Sustainable urban transportation solutions using electric micro-mobility',
      'Transportation & Mobility',
      'Seed',
      'under_review',
      'Berlin, Germany',
      'Germany',
      '2022',
      '8',
      'Sarah Chen;Michael Brown',
      'https://ecomobility.com',
      '',
      '',
      'https://linkedin.com/company/ecomobility',
      '2000000',
      '500000',
      'B2C – Business to Consumer;D2C – Direct to Consumer',
      'Transportation & Mobility;Energy & Sustainability',
      'Europe',
      '',
      '',
      'Regulatory risks managed through partnerships with city governments',
      'Germany, Austria',
      'Netherlands, Belgium (2025)',
      'EUR',
      'Sarah',
      'Chen',
      'https://linkedin.com/in/sarahchen',
      '+44 20 7123 4567',
      '4',
      '10-25',
      '300000'
    ]
  ];

  // Create workbook
  const wb = XLSX.utils.book_new();

  // Add Instructions sheet
  const wsInstructions = XLSX.utils.aoa_to_sheet(instructions);
  XLSX.utils.book_append_sheet(wb, wsInstructions, 'Instructions');

  // Add Data Template sheet
  const wsData = XLSX.utils.aoa_to_sheet([headers, ...exampleRows]);
  XLSX.utils.book_append_sheet(wb, wsData, 'Data Template');

  // Generate file and trigger download
  const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
  const blob = new Blob([wbout], { type: 'application/octet-stream' });
  const link = document.createElement('a');
  const url = URL.createObjectURL(blob);
  
  link.setAttribute('href', url);
  link.setAttribute('download', 'startup_template.xlsx');
  link.style.visibility = 'hidden';
  
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}